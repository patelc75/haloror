<% end_time = Time.now
   begin_time = 1.day.ago(end_time)
   total_time = (end_time - begin_time)
   users, total_lost_data, total_not_worn = DailyReports.device_not_worn_halousers(begin_time, end_time) 
   vital = Vital.find(:first, :conditions => "timestamp <= '#{end_time}' AND timestamp >= '#{begin_time}'", :order => 'timestamp desc') 
   valid_time = ''
	if vital
		valid_time = vital.timestamp.to_s
	end -%>
Device Not Worn:
All times are in UTC timezone
	Starting Time: <%= begin_time %>
	Ending   Time: <%= end_time %>
Valid thru:  <%=  valid_time %>
Name    Not Worn    Lost Data    Total Duration    Compliance Percentage
------------------------------------------------------------------------
All     <%= total_not_worn %>    <%= total_lost_data %>    <%= total_lost_data + total_not_worn %>
<% users.each do |user| -%><% if user[:total] != 0 -%><%= user.name %>    <%= UtilityHelper.seconds_format(user[:seconds_not_worn])%>    <%= UtilityHelper.seconds_format(user[:seconds_lost_data])%>    <%= UtilityHelper.seconds_format(user[:total])%>    <%= ((total_time - user[:total]) / total_time).round(2) %> <% end -%><% end -%>
------------------------------------------------------------------------